<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <title>Commons-encryption by TheBlackChamber</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>Commons-encryption</h1>
        <h2></h2>

        <section id="downloads">
          <a href="https://github.com/TheBlackChamber/commons-encryption/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/TheBlackChamber/commons-encryption/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/TheBlackChamber/commons-encryption" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1>
<a name="commons-encryption" class="anchor" href="#commons-encryption"><span class="octicon octicon-link"></span></a>commons-encryption</h1>

<h3>
<a name="pre-requisites" class="anchor" href="#pre-requisites"><span class="octicon octicon-link"></span></a>Pre-Requisites</h3>

<p>Prior to making use of the commons-encryption library it may be necessary to install the <a href="http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html">Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy Files</a>.</p>

<h3>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h3>

<p>In order to make use of the commons-encryption library you first need to download the jars from here on github, or alternatively if you use maven you will soon be able to download the dependency from maven central repository.</p>

<h6>
<a name="maven-dependency" class="anchor" href="#maven-dependency"><span class="octicon octicon-link"></span></a>Maven Dependency</h6>

<div class="highlight highlight-XML"><pre><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>net.theblackchamber<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>commons-encryption<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>.1<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>

<p>After the commons-encryption library has been added to your project usage is pretty straight forward. Generally the classes you will be interacting with will be in the implementations, util, and providers packages. Specific examples of use can be found in the <a href="http://sminogue.github.io/commons-encryption/api">API</a> documents located on the <a href="http://sminogue.github.io/commons-encryption">project website</a> and in the unit tests under src/test/java.</p>

<h3>
<a name="examples" class="anchor" href="#examples"><span class="octicon octicon-link"></span></a>Examples:</h3>

<h6>
<a name="key-generation" class="anchor" href="#key-generation"><span class="octicon octicon-link"></span></a>Key Generation</h6>

<p>The following snippet of code is an example of generating a 256 bit AES key and adding it to a keystore on disk with the key entry name of "aes-key" and the keystore encrypted using the password "TEST".</p>

<div class="highlight highlight-java"><pre><span class="n">KeyConfig</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">KeyConfig</span><span class="o">(</span><span class="n">keyStoreFile</span><span class="o">,</span> <span class="s">"TEST"</span><span class="o">,</span> <span class="mi">256</span><span class="o">,</span> <span class="n">SupportedAlgorithms</span><span class="o">.</span><span class="na">AES</span><span class="o">,</span> <span class="s">"aes-key"</span><span class="o">);</span>
<span class="n">KeystoreUtils</span><span class="o">.</span><span class="na">generateAESSecretKey</span><span class="o">(</span><span class="n">config</span><span class="o">);</span>
</pre></div>

<h6>
<a name="secureproperties" class="anchor" href="#secureproperties"><span class="octicon octicon-link"></span></a>SecureProperties</h6>

<p>SecureProperties is an attempt to provide a transparent extension of the native java Properties class which allows property values to be encrypted at rest. Be aware of the exceptions thrown by methods as described in the <a href="http://sminogue.github.io/commons-encryption/api">API</a>... Methods throw a custom unchecked runtime exception.</p>

<h6>
<a name="testproperties" class="anchor" href="#testproperties"><span class="octicon octicon-link"></span></a>test.properties</h6>

<div class="highlight highlight-properties"><pre><span class="na">entry-name</span><span class="o">=</span><span class="s">aes-key</span>
<span class="na">keystore-password</span><span class="o">=</span><span class="s">changeit</span>
<span class="na">key-path</span><span class="o">=</span><span class="s">/my/key/location</span>
<span class="na">key1</span><span class="o">=</span><span class="s">My Unencrypted Property Value</span>
<span class="na">key2-encrypted</span><span class="o">=</span><span class="s">FAB123DE7A012FCD</span>
</pre></div>

<p>The following snipped of code is an example of loading a properties file from disk into a SecureProperties object which can be used in existing java classes.</p>

<div class="highlight highlight-java"><pre><span class="n">FileReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">FileReader</span><span class="o">(</span><span class="n">propertiesFile</span><span class="o">);</span>
<span class="n">Properties</span> <span class="n">sProperties</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">SecureProperties</span><span class="o">();</span>
<span class="n">sProperties</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">reader</span><span class="o">);</span>
<span class="n">String</span> <span class="n">clearKey2</span> <span class="o">=</span> <span class="n">sProperties</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"key2-encrypted"</span><span class="o">);</span>
<span class="n">sProperties</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">"key3-unencrypted"</span><span class="o">,</span><span class="s">"cleartext value"</span><span class="o">);</span>
</pre></div>

<h6>
<a name="aesencryptionprovider" class="anchor" href="#aesencryptionprovider"><span class="octicon octicon-link"></span></a>AESEncryptionProvider</h6>

<p>If you find yourself needing to build your own "implementation" using encryption or just want to manually encrypt/decrypt values. The providers can be used directly.</p>

<div class="highlight highlight-java"><pre><span class="n">SecretKey</span> <span class="n">key</span> <span class="o">=</span> <span class="n">KeystoreUtils</span><span class="o">.</span><span class="na">getAESSecretKey</span><span class="o">(</span><span class="n">keyfile</span><span class="o">,</span> <span class="s">"aes-key"</span><span class="o">,</span> <span class="s">"TEST"</span><span class="o">);</span>
<span class="n">AESEncryptionProvider</span> <span class="n">encryptionProvider</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">AESEncryptionProvider</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
<span class="n">String</span> <span class="n">cipherText</span> <span class="o">=</span> <span class="n">encryptionProvider</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="s">"clear text"</span><span class="o">);</span>
</pre></div>

<h6>
<a name="securepropertiesutils" class="anchor" href="#securepropertiesutils"><span class="octicon octicon-link"></span></a>SecurePropertiesUtils</h6>

<p>The SecurePropertiesUtils is a utility class primarily used to initially encrypt a clear text properties file in preperation of deploying it to a server. This is so that you can keep a clear text version in your project, edit it, and then easily in one step encrypt the fields which need to be secured and then deploy. Important to note that while a SecureProperties instance is returned the file IS changed on disk as well, the returned SecureProperties is just a convenience.</p>

<div class="highlight highlight-properties"><pre><span class="na">entry-name</span><span class="o">=</span><span class="s">aes-key</span>
<span class="na">keystore-password</span><span class="o">=</span><span class="s">changeit</span>
<span class="na">key-path</span><span class="o">=</span><span class="s">/my/key/location</span>
<span class="na">key1</span><span class="o">=</span><span class="s">My Unencrypted Property Value</span>
<span class="na">key2-unencrypted</span><span class="o">=</span><span class="s">This Will Be Encrypted</span>
</pre></div>

<div class="highlight highlight-java"><pre><span class="n">SecureProperties</span> <span class="n">sProperties</span> <span class="o">=</span> <span class="n">SecurePropertiesUtils</span><span class="o">.</span><span class="na">encryptPropertiesFile</span><span class="o">(</span><span class="n">propertiesFile</span><span class="o">);</span>
</pre></div>
      </section>
    </div>

    
  </body>
</html>